<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

	<title>Mapa dos Pólos UAB</title>
	<meta charset="utf-8">
	<script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
	<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
	<link rel="stylesheet" href="../style/app.css" />

	<script type='text/javascript' src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

	<script src="../json/ipes-all.json" type="text/javascript"></script>

  <script src=" https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.min.js"></script>

</head>
<body>

	<script>
	regioes = {
    "AC" : "Norte",
    "AL" : "Nordeste",
    "AP" : "Norte",
    "AM" : "Norte",
    "BA" : "Nordeste",
    "CE"  : "Nordeste",
    "DF"  : "Centro-Oeste",
    "ES"  : "Sudeste",
    "GO"  : "Centro-Oeste",
    "MA"  : "Nordeste",
    "MS"  : "Centro-Oeste",
    "MT"  : "Centro-Oeste",
    "MG"  : "Sudeste",
    "PA"  : "Norte",
    "PB"  : "Nordeste",
    "PR"  : "Sul",
    "PE"  : "Nordeste",
    "PI"  : "Nordeste",
    "RJ"  : "Sudeste",
    "RN"  : "Nordeste",
    "RS"  : "Sul",
    "RO"  : "Norte",
    "RR"  : "Norte",
    "SC"  : "Sul",
    "SP"  : "Sudeste",
    "SE"  : "Nordeste",
    "TO"  : "Norte"}


	//Cores para serem usadas no chart
	Colors = {};
	Colors.names = {
	  blue: "#AEC6CF",
	  brown: "#836953",
	  darkblue: "#779ECB",
	  darkcyan: "#008b8b",
	  darkgrey: "#CFCFC4",
	  darkgreen: "#006400",
	  darkkhaki: "#bdb76b",
	  darkolivegreen: "#556b2f",
	  darkorange: "#C46210",
	  darkorchid: "#9932cc",
	  darkred: "#8b0000",
	  darksalmon: "#e9967a",
	  gold: "#ffd700",
	  mantisgreen: "#74C365",
	  indigo: "#4b0082",
	  pastelblue: "#73A9C2",
	  pastelgreen: "#77DD77",
	  lightgrey: "#696969",
	  pastelpurple: "#B39EB5",
	  maroon: "#800000",
	  navy: "#000080",
	  olive: "#808000",
	  pastelorange: "#FFB347",
	  purple: "#800080",
	  violet: "#CB99C9",
	  rubyred: "#9B111E",
	  yellow: "#ffff00"
	};

	Colors.random = function() {
	  var result = 0;
	  var count = 0;
	  for (var prop in this.names)
	      if ( (Math.random() < 1/++count) && (result === 0)) {
	         result = this.names[prop];
	         delete this.names[prop];
	       }

	  return result;
	};


	var base = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
	  attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
	  });

	var brasil = L.geoJson(null, {
		style: {
			weight: 1,
			color: "#fff",
			opacity: 1,
			fillColor: "#ccc",
			fillOpacity: 1
			}
			});
			$.getJSON("br_estados.json", function(data) {
				brasil.addData(data);
			});


	var polosRegiao = {};
	var dadosChart = [];

	var ipes = L.geoJson(null, {onEachFeature: onEachFeature, pointToLayer: pointToLayer});
	$.getJSON("ipes-all.json", function (data) {
	  ipes.addData(data);

		//Todo esse código abaixo é necessário para se gerar o gráfico de pizza

		$.each(data.features, function (key, val) {
			//se não existe esse estado na lista cria
			if (!(regioes[val.properties.Estado] in polosRegiao)) {
				polosRegiao[regioes[val.properties.Estado]] = 1;
			} else {
				//se existe, soma ao valor
				polosRegiao[regioes[val.properties.Estado]] ++ ;
			}

		});

		$.each(polosRegiao, function (regiao, qtde) {
			dadosChart.push({
				"label": regiao,
				"value": qtde,
				"color": Colors.random()
			});
		});

	});


//Versão polos por estado em pizza
	function polosPorEstado (myBarChart){
		var polosEstado = {};

		$.getJSON("ipes-all.json", function (data) {
			$.each(data.features, function (key, val) {
				//se não existe esse estado na lista cria
				if (!(val.properties.Estado in polosEstado)) {
					polosEstado[val.properties.Estado] = 1;
				}else {
					//se existe, soma ao valor
					polosEstado[val.properties.Estado] ++ ;
				}

			});

			//sorting the polos
			var polosOrdenados = [];
			for (var polo in polosEstado)
			      polosOrdenados.push([polo, polosEstado[polo]])
			polosOrdenados.sort(function(a, b) {return b[1] - a[1]})
			//polosOrdenados = [[estado,qtde],...]

			for (i = 0; i < polosOrdenados.length; i++) {
		    myBarChart.addData([polosOrdenados[i][1]],polosOrdenados[i][0]);
			}

			// $.each(polosEstado, function (estado, qtde) {
			// 	myBarChart.addData([qtde],estado);
			// });
			myBarChart.update();

		});
}

  function onEachFeature (feature, marker) {
		if (feature.properties) {
			marker.bindPopup(
				'<b>' + feature.properties.Sigla + '</b>' + '<br>' +
				feature.properties.Cidade + ', ' + feature.properties.Estado + '</br>' +
				feature.properties.Logradouro + ' - ' + feature.properties.Bairro + '</br>' +
				feature.properties.CEP + '</br>' +
				'Telefone :' + feature.properties.Telefone + '</br>' +
				'<a href="' + feature.properties.URL + '">' + feature.properties.URL + '</a>'
			)
		}
	};

	function pointToLayer (feature, latlng) {
		 return L.circleMarker(latlng, {
			 radius: 6,
			 fillColor: "#267FCA", color: "#000",
			 weight: 1,
			 opacity: 1,
			 fillOpacity: 0.3
		 });
	 };

</script>

<h1>Sobre o projeto</h1>

<div class="pontoschave">Este site apresenta os resultados de um projeto de pesquisa iniciado em 2013
  focado na Universidade Aberta do Brasil realizado em parceria entre a UNICAMP, UFF e UEL, e que desde 2015,
  também conta com a participação da UnB. O mapa apresenta duas bases de dados:<br><br>
	(1) Uma base de informações
  extraídas do <a href="http://sisuab.uab.capes.gov">SisUAB</a> em março de 2016, tornando público o acesso
  a informações sobre a UAB. Trazemos a tona um mapa com todas as IPES (Instutições Públicas de Ensino Superior)
	e todos os polos <i>ativos</i>, que juntos, compõe o Sistema UAB. Para cada um desses, apontamos um histórico
	detalhado sobre cursos e alunos participantes. Vale ressaltar que não incluímos os cursos que não tiveram oferta real de início,
	ou seja, cursos que podem ter sido planejados mas não chegaram a ser efetivados. Os dados de geolocalização
	são aproximados. Buscamos apontar com a maior especificidade possível, a localização das IPES (feitas manualmente).
	Os polos forma geolocalizados automaticamente e referem a cidade, sem precisão no nível de logradouro. <br><br>
  (2) Informações detalhadas sobre os Núcleos de Educação a Distância de 8 universidades que participaram de uma pesquisa realizada
  pelo nosso grupo focada na gestão de recursos educacionais no âmbito da UAB. Para essas instituições
	incluímos um texto introdutório e uma detalhada linha do tempo de sua participação na UAB.
	Esses espaços são responsáveis  pela articulação, dentro da universidade, para a efetivação dos cursos oferecidos pela UAB.
   Como cada universidade tem autonomia para definir seu modelo de ação, cada um desses núcleos se
   estrutura de maneira diferente. O objetivo desses estudo é descrever e avaliar questões relativas ao
   funcionamento e estrutura desses centros, com particular atenção aos processos de produção e disseminação de
   recursos educacionais.<br><br>

 A nossa meta com esse projeto é dar maior visibilidade a uma iniciativa de educação pública ainda pouco estudada
e divulgada. Buscamos com isso, trazer maior "abertura" para o funcionamento do Sistema UAB,
bem como maior transparência sobre a sua abrangência, capilaridade e ações.</div>

<div class= "graph">
<h2>Dados gerais da UAB: número de IPES por estado</h2>
<!-- Gráfico de Barras-->
<canvas id="chartByState" width="800" height="300"></canvas>

<h2>Dados gerais da UAB: Número de IPES por região</h2>
<!--O código à seguir também é necessário para o gráfico de pizza -->
<canvas id="chartByRegion"></canvas>
</div>
<br><br>
<div class="subtitle">Para saber mais sobre a UAB</div>
<p>Sobre núcleos e produção de recursos educacionais:</p>
<div class="cit">Duran, M. R. C., Amiel, T., Martins, E., & Costa, C. J. da. (2014). Modelos estruturais de gestão EaD nas instituições públicas de ensino superior do Brasil (pp. 1–12). Presented at the Congresso Iberoamericano de Ciencia, Tecnología, Innovacíon y Educacíon, Buenos Aires: OEI. Disponível em: <a href="http://www.oei.es/congreso2014">http://www.oei.es/congreso2014</a></div>
<br>Enfoque nos polos:<br>
<div class="cit">Duran, M. R. da C., Costa, C. J. da, Massaro, T., & Amiel, T. (2012). Os polos do sistema UAB e seus coordenadores nas regiões nordeste, norte e sul do Brasil (pp. 1–15). Presented at the Simpósio Internacional de Educação a Distância, UFScar. Disponível em: <a href="http://sistemas3.sead.ufscar.br/ojs/Trabalhos/277-937-3-ED.pdf">http://sistemas3.sead.ufscar.br/ojs/Trabalhos/277-937-3-ED.pdf</a></div>
<Br>Sobre a UAB:<br>
<div class="cit">Costa, C. J. da, & Duran, M. R. C. (2011). A Política Nacional de Formação de Professores entre 2005 e 2010: a nova Capes e o Sistema Universidade Aberta do Brasil. Revista Brasileira de Pós-Graduação, 9(16), 263–313. Disponível em: <a href="http://ojs.rbpg.capes.gov.br/index.php/rbpg/article/view/289/0">http://ojs.rbpg.capes.gov.br/index.php/rbpg/article/view/289/0</a></div>

<script>

window.onload = function(){
		//for bar grpah
		initialData = {
			labels : [],
			datasets :[{
				fillColor: "blue",
				data :[]
			}]

		};
		var ctxBar = document.getElementById("chartByState").getContext("2d");
		var myBarChart = new Chart(ctxBar).Bar(initialData, {barShowStroke: false});
		polosPorEstado(myBarChart);

		//for pie graph
		var options =
	  {
				//animation: false;

	      tooltipTemplate: "<%if (label){%><%=label%>: <%}%><%= value %>",

	      onAnimationComplete: function()
	      {
	          this.showTooltip(this.segments, true);
	      },

	      tooltipEvents: [],

	      showTooltips: true
	  }

		var ctx = document.getElementById("chartByRegion").getContext("2d");
    var myPieChart = new Chart(ctx).Pie(dadosChart,options);


}

</script>
</body>
</html>
